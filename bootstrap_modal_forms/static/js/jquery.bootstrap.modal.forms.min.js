!function(d){var e=function(a){d(a.submitBtn).on("click",function(o){n(a,t)}),d(a.modalID).on("hidden.bs.modal",function(o){d(a.modalForm).remove()})},n=function(a,n){d.ajax({type:d(a.modalForm).attr("method"),url:d(a.modalForm).attr("action"),data:new FormData(d(a.modalForm)[0]),contentType:!1,processData:!1,beforeSend:function(){d(a.submitBtn).prop("disabled",!0)},success:function(o){0<d(o).find(a.errorClass).length?(d(a.modalID).find(a.modalContent).html(o),d(a.modalForm).attr("action",a.formURL),e(a)):n(a)}})},t=function(t){var s,o;t.asyncUpdate?(o=a(t.asyncSettings),s=t.asyncSettings,o&&((o=new FormData(d(t.modalForm)[0])).append("asyncUpdate","True"),d.ajax({type:d(t.modalForm).attr("method"),url:d(t.modalForm).attr("action"),data:o,contentType:!1,processData:!1,success:function(o){var a,n=d("body");0===n.length&&console.error("django-bootstrap-modal-forms: <body> element missing in your html."),n.prepend(s.successMessage),a=s.passFormDataToNextPage?(a=d(t.modalForm).serialize(),s.dataUrl+(-1!=s.dataUrl.indexOf("?")?"&"+a:"?"+a)):s.dataUrl,d.ajax({type:"GET",url:a,dataType:"json",success:function(o){d(s.dataElementId).html(o[s.dataKey]),s.addModalFormFunction&&s.addModalFormFunction(),s.closeOnSubmit?d(t.modalID).modal("hide"):d(t.modalID).find(t.modalContent).load(t.formURL,function(){d(t.modalForm).attr("action",t.formURL),e(t)})}})}}))):d(t.modalForm).submit()},a=function(o){var a=[];return o.successMessage||(a.push("successMessage"),console.error("django-bootstrap-modal-forms: 'successMessage' in asyncSettings is missing.")),o.dataUrl||(a.push("dataUrl"),console.error("django-bootstrap-modal-forms: 'dataUrl' in asyncSettings is missing.")),o.dataElementId||(a.push("dataElementId"),console.error("django-bootstrap-modal-forms: 'dataElementId' in asyncSettings is missing.")),o.dataKey||(a.push("dataKey"),console.error("django-bootstrap-modal-forms: 'dataKey' in asyncSettings is missing.")),o.addModalFormFunction||(a.push("addModalFormFunction"),console.error("django-bootstrap-modal-forms: 'addModalFormFunction' in asyncSettings is missing.")),!(0<a.length)};d.fn.modalForm=function(o){var n=d.extend({modalID:"#modal",modalContent:".modal-content",modalForm:".modal-content form",formURL:null,errorClass:".invalid",submitBtn:".submit-btn",asyncUpdate:!1,asyncSettings:{closeOnSubmit:!1,successMessage:null,dataUrl:null,dataElementId:null,dataKey:null,addModalFormFunction:null}},o);return this.each(function(){d(this).click(function(o){var a;d((a=n).modalID).find(a.modalContent).load(a.formURL,function(){d(a.modalID).modal("show"),d(a.modalForm).attr("action",a.formURL),e(a)})})}),this}}(jQuery);
